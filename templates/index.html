{% extends 'layout.html' %}

{% block extraheaders %}
<link rel="stylesheet" href="/css/font-awesome.css" />
{% endblock %}

{% block content %}
<div><a id="dashurl" href=""></a></div>
<div id="buttons" data-page="{{page}}">
  <table class="btn-grid table table-striped table-bordered table-sm">
    <thead>
      <tr>
        <th class="active manifest">Manifest</th>
        <th class="option">Options</th></tr>
      </thead>
    <tbody>
      {% for row in rows %}
      <tr id="row{{loop.index0}}">
        {% if row.manifest %}
        <td class="manifest active"
            data-uri="{{row.url}}"
            data-filename="{{row.filename}}"
            data-params="{{row.manifest.restrictions|toJson|escape}}">
          <span class="key manifest-key active">{{loop.index0}}</span>
          {% if row.manifest.title %}
          <a class="manifest-title" href="{{row.url}}">{{row.manifest.title}}</a>
          <img class="bool-yes" src="/img/tick-icon.png" />
          {% endif %}
        </td>
        {% else %}
        <td class="manifest empty" />
        {% endif %}
        <td class="option">
          <span class="key option-key">{{loop.index0}}</span>
          <span class="option-title">{{row.option.title}}</span>
          {% if row.option.name %}
          <select name="{{row.option.name}}">
            {% for opt in row.option.options %}
            <option value="{{opt[1]}}">{{opt[0]}}</option>
            {% endfor %}
          </select>
          {% endif %}
        </td>
        </tr>
      {% endfor %}
      <tr class="play-row"><td colspan="2" id="play-cell">
          <div id="play-button" class="disabled" >
            <a class="button play-icon"><span class="fa fa-play icon"></span></a>
            <select name="stream" class="play-select">
            {% for stream in streams %}
            <option value="{{stream.prefix}}">Play {{stream.title}}</option>
            {% endfor %}
            </select>
          </div>
      </td></tr>
    </tbody>
  </table>
</div>
  <p class="info">
    The MPD files for live streams are dynamically
    generated so that they appear to be live sources, using static media files.
    Requests for manifests and for media fragments can be modified
    using various CGI parameters, which are documented on the
    <a href="{{uri_for('cgi-options')}}" class="link">CGI options</a> page.
  </p>
  <div class="container">
  <div class="representations row">
    <div clsss="video-representations col">
    <table class="table table-striped">
      <caption>Video Representations</caption>
      <thead><tr>{% for f in video_fields %}<th class="{{f}}">{{f}}</th>{% endfor %}</tr></thead>
      <tbody>
        {% for rep in video_representations %}
        <tr>
          {% for f in video_fields %}<td class="{{f}}">{{rep[f]|toHtmlString}}</td>{% endfor %}
        </tr>
        {% endfor %}
      </tbody>
    </table>
    </div>
    <div class="audio-representations col">
    <table class="table table-striped">
      <caption>Audio Representations</caption>
      <thead><tr>
          {% for f in audio_fields %}
          <th class="{{f}}">{% if f=="numChannels" %}channels{% else
          %}{{f}}{% endif %}</th>
          {% endfor %}
      </tr></thead>
      <tbody>
        {% for repr in audio_representations %}
        <tr>
          {% for f in audio_fields %}
          <td class="{{f}}">{{repr[f]|toHtmlString}}</td>
          {% endfor %}
        </tr>
        {% endfor %}
      </tbody>
    </table>
    </div>
  </div>
  </div>
{% endblock %}

{% block scripts %}
  {{import_script("jquery-3.4.1")}}
  <script src="/js/main.js" type="text/javascript"></script>
{% endblock %}
